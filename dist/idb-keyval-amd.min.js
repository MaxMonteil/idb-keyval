define(["exports"],function(e){"use strict";const t=(e,t)=>new Promise((r,o)=>{e.onerror=(()=>o(e.error)),e.onsuccess=(()=>r(e.result)),e.onupgradeneeded=(()=>{e.result.createObjectStore(t)})});class r{constructor(e="keyval-store",r="keyval"){this.storeName=r,this._dbp=t(indexedDB.open(e),r)}_withIDBStore(e,t){return this._dbp.then(r=>new Promise((o,n)=>{const s=r.transaction(this.storeName,e);s.oncomplete=(()=>o()),s.onabort=s.onerror=(()=>n(s.error)),t(s.objectStore(this.storeName))}))}}let o;function n(){return o||(o=new r),o}e.Store=r,e.MultiStore=class extends r{constructor(e="keyval-store",r="keyval"){super(e,r),this.storeName=r,this._dbup=this._dbp.then(o=>o.objectStoreNames.contains(r)?o:(o.close(),t(indexedDB.open(e,o.version+1),r)))}_withIDBStore(e,t){return this._dbup.then(()=>super._withIDBStore(e,t))}},e.get=function(e,t=n()){let r;return t._withIDBStore("readonly",t=>{r=t.get(e)}).then(()=>r.result)},e.set=function(e,t,r=n()){return r._withIDBStore("readwrite",r=>{r.put(t,e)})},e.del=function(e,t=n()){return t._withIDBStore("readwrite",t=>{t.delete(e)})},e.clear=function(e=n()){return e._withIDBStore("readwrite",e=>{e.clear()})},e.keys=function(e=n()){const t=[];return e._withIDBStore("readonly",e=>{(e.openKeyCursor||e.openCursor).call(e).onsuccess=function(){this.result&&(t.push(this.result.key),this.result.continue())}}).then(()=>t)},Object.defineProperty(e,"__esModule",{value:!0})});